<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script>const nvDArt=1;</script>
</head>
<body>
        <div id="myDiv" onclick="a()">
            cache ceci dsqjqk njqdsk
        </div>
    
    <script>
        function a(){
// const div = document.getElementById("myDiv");
// const selection = window.getSelection();
// const range = selection.getRangeAt(0);
// const cursorPos = range.startOffset;
// const currentChar = range.endContainer.textContent.charAt(cursorPos);
// console.log("Le caractère courant est :", currentChar);
// console.log("Index :", range);
const div = document.getElementById("myDiv");
const selection = window.getSelection();
const range = selection.getRangeAt(0);
const selectedText = range.toString();
const textBeforeSelection = div.textContent.substring(0, range.startOffset);
const normalizedOffset = textBeforeSelection.replace(/^\s+|\s+$/g, "").length;
const cursorIndex = selectedText.trim().length + normalizedOffset - selectedText.length;
console.log("L'index du caractère courant est :", cursorIndex);
console.log("L'index du caractère courant est :", selection);
}    </script>
</body>
</html>